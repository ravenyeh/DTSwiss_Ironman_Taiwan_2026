<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>鐵人三項訓練計劃</title>
    <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,%3Csvg viewBox='0 0 48 48' xmlns='http://www.w3.org/2000/svg'%3E%3Ccircle cx='24' cy='24' r='23' fill='%231a1a2e' stroke='%23e94560' stroke-width='2'/%3E%3Cpath d='M8 18 Q12 14, 16 18 T24 18 T32 18 T40 18' fill='none' stroke='%2300d4ff' stroke-width='2.5' stroke-linecap='round'/%3E%3Ccircle cx='17' cy='28' r='6' fill='none' stroke='%23ffd700' stroke-width='2'/%3E%3Ccircle cx='17' cy='28' r='2' fill='%23ffd700'/%3E%3Cpath d='M17 28 L22 24 L28 28 M22 24 L22 20 L25 20' fill='none' stroke='%23ffd700' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3Ccircle cx='35' cy='22' r='3' fill='%23e94560'/%3E%3Cpath d='M35 25 L35 32 M35 28 L31 31 M35 28 L39 31 M35 32 L32 38 M35 32 L38 38' stroke='%23e94560' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <nav class="nav">
            <div class="nav-logos">
                <span class="nav-race-name" id="navRaceName">鐵人三項訓練計劃</span>
                <span class="nav-logo-separator">×</span>
                <img src="images/garmin-logo-white.svg" alt="Garmin" class="nav-logo garmin-logo">
            </div>
            <ul class="nav-links">
                <li><a href="#goals">目標</a></li>
                <li><a href="#schedule">訓練計劃</a></li>
                <li><a href="#strategy">策略</a></li>
                <li><a href="#race-day">比賽日</a></li>
            </ul>
            <a href="https://www.instagram.com/yehraven/" target="_blank" class="nav-profile">
                <svg class="logo-icon" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
                    <circle cx="24" cy="24" r="23" fill="#1a1a2e" stroke="#e94560" stroke-width="2"/>
                    <path d="M8 18 Q12 14, 16 18 T24 18 T32 18 T40 18" fill="none" stroke="#00d4ff" stroke-width="2.5" stroke-linecap="round"/>
                    <circle cx="17" cy="28" r="6" fill="none" stroke="#ffd700" stroke-width="2"/>
                    <circle cx="17" cy="28" r="2" fill="#ffd700"/>
                    <path d="M17 28 L22 24 L28 28 M22 24 L22 20 L25 20" fill="none" stroke="#ffd700" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                    <circle cx="35" cy="22" r="3" fill="#e94560"/>
                    <path d="M35 25 L35 32 M35 28 L31 31 M35 28 L39 31 M35 32 L32 38 M35 32 L38 38" stroke="#e94560" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
            </a>
        </nav>
    </header>

    <!-- Hero Section -->
    <section class="hero">
        <div class="hero-overlay"></div>
        <div class="hero-content">
            <div class="countdown-container">
                <span class="countdown-label">距離比賽還有</span>
                <div class="countdown-timer">
                    <div class="countdown-item">
                        <span class="countdown-value" id="countdown-days">---</span>
                        <span class="countdown-unit">天</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="countdown-hours">--</span>
                        <span class="countdown-unit">時</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="countdown-minutes">--</span>
                        <span class="countdown-unit">分</span>
                    </div>
                    <div class="countdown-item">
                        <span class="countdown-value" id="countdown-seconds">--</span>
                        <span class="countdown-unit">秒</span>
                    </div>
                </div>
            </div>
            <div class="hero-title-row">
                <h1 id="raceTitle">鐵人三項訓練</h1>
                <button class="btn-race-settings" id="btnRaceSettings" title="設定比賽資訊">⚙️</button>
                <div class="hero-date">
                    <span class="date-label">比賽日期</span>
                    <span class="date-value" id="raceDateDisplay">請設定比賽日期</span>
                </div>
            </div>
            <!-- Race Settings Modal -->
            <div class="race-settings-modal" id="raceSettingsModal">
                <div class="race-settings-content">
                    <h3>選擇比賽</h3>
                    <p class="settings-hint">選擇您的目標比賽，系統會自動設定倒數計時</p>
                    <div class="race-settings-form">
                        <div class="form-group">
                            <label for="raceSelect">比賽</label>
                            <select id="raceSelect">
                                <option value="">-- 請選擇比賽 --</option>
                                <option value="puyuma">2026 普悠瑪鐵人三項 (3/28)</option>
                                <option value="ironman">2026 IRONMAN 澎湖 (4/12)</option>
                                <option value="challenge">2026 Challenge Taiwan (4/25)</option>
                            </select>
                        </div>
                    </div>
                    <div class="race-settings-actions">
                        <button class="btn-save-race" id="btnSaveRace">確定</button>
                        <button class="btn-cancel-race" id="btnCancelRace">取消</button>
                    </div>
                </div>
            </div>
            <h2>20週訓練計劃</h2>
            <div class="hero-stats">
                <div class="stat">
                    <img src="./images/swim.png" alt="游泳" class="stat-icon-img">
                    <span class="stat-value">3.8km</span>
                    <span class="stat-label">游泳</span>
                </div>
                <div class="stat">
                    <img src="./images/cycling.png" alt="自行車" class="stat-icon-img">
                    <span class="stat-value">180km</span>
                    <span class="stat-label">自行車</span>
                </div>
                <div class="stat">
                    <img src="./images/run.png" alt="跑步" class="stat-icon-img">
                    <span class="stat-value">42.2km</span>
                    <span class="stat-label">跑步</span>
                </div>
            </div>
            <div class="today-training" id="todayTraining">
                <div class="today-training-left">
                    <div class="today-training-header">
                        <span class="today-label" id="todayLabel">今日訓練</span>
                    </div>
                    <div class="today-training-content">
                        <div class="today-tags">
                            <div class="today-phase" id="todayPhase"></div>
                            <div class="today-intensity" id="todayIntensity"></div>
                        </div>
                        <div class="today-description" id="todayDescription"></div>
                        <div class="today-stats">
                            <span class="today-stat" id="todaySwim"></span>
                            <span class="today-stat" id="todayBike"></span>
                            <span class="today-stat" id="todayRun"></span>
                            <span class="today-stat" id="todayHours"></span>
                        </div>
                    </div>
                    <div class="today-note" id="todayNote"></div>
                    <div class="today-motivation" id="todayMotivation"></div>
                </div>
                <div class="today-actions" id="todayActions"></div>
            </div>
        </div>
        <div class="scroll-indicator">
            <span>向下滾動</span>
            <div class="scroll-arrow"></div>
        </div>
    </section>

    <!-- Goals Section -->
    <section id="goals" class="section goals-section">
        <div class="container">
            <h2 class="section-title">挑戰目標</h2>
            <div class="goal-highlight">
                <div class="goal-main">
                    <span class="goal-text">突破</span>
                    <span class="goal-number">12</span>
                    <span class="goal-text">小時大關</span>
                </div>
                <p class="goal-description">
                    2025年Challenge Taiwan賽後，我深知自己在各項目仍有很大進步空間。這次 IRONMAN 澎湖，我要將完賽時間從 <strong>13:00:38</strong> 壓縮到 <strong>12 小時以內</strong>，實現質的飛躍！
                </p>
            </div>

            <div class="comparison-table">
                <div class="table-header">
                    <div class="col">項目</div>
                    <div class="col">2026目標</div>
                    <div class="col">目標配速</div>
                    <div class="col">2025成績</div>
                    <div class="col">需進步</div>
                </div>
                <div class="table-row swim">
                    <div class="col"><img src="images/swim.png" class="icon-img" alt="游泳"> 游泳 3.8km</div>
                    <div class="col highlight">1:35:00</div>
                    <div class="col">2:30/100m</div>
                    <div class="col">1:46:46</div>
                    <div class="col improve">-11:46 (11%)</div>
                </div>
                <div class="table-row bike">
                    <div class="col"><img src="images/cycling.png" class="icon-img" alt="自行車"> 自行車 180km</div>
                    <div class="col highlight">6:00:00</div>
                    <div class="col">30.0 km/h</div>
                    <div class="col">6:41:11</div>
                    <div class="col improve">-41:11 (10%)</div>
                </div>
                <div class="table-row run">
                    <div class="col"><img src="images/run.png" class="icon-img" alt="跑步"> 跑步 42km</div>
                    <div class="col highlight">4:05:00</div>
                    <div class="col">5:49/km</div>
                    <div class="col">4:19:38</div>
                    <div class="col improve">-14:38 (6%)</div>
                </div>
                <div class="table-row transition">
                    <div class="col"><span class="icon">🔄</span> T1 轉換</div>
                    <div class="col highlight">5:00</div>
                    <div class="col">-</div>
                    <div class="col">7:46</div>
                    <div class="col improve">-2:46 (36%)</div>
                </div>
                <div class="table-row transition">
                    <div class="col"><span class="icon">🔄</span> T2 轉換</div>
                    <div class="col highlight">3:00</div>
                    <div class="col">-</div>
                    <div class="col">4:11</div>
                    <div class="col improve">-1:11 (28%)</div>
                </div>
                <div class="table-row total">
                    <div class="col"><strong>總計</strong></div>
                    <div class="col highlight"><strong>11:48:00</strong></div>
                    <div class="col">-</div>
                    <div class="col"><strong>13:00:38</strong></div>
                    <div class="col improve"><strong>-1:12:38</strong></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Training Schedule Section -->
    <section id="schedule" class="section schedule-section">
        <div class="container">
            <!-- User Settings Banner -->
            <div class="settings-summary-banner" id="settingsSummaryBanner">
                <div class="summary-content">
                    <span class="summary-label">⚙️ 課表已依照您的設定客製化：</span>
                    <div class="summary-values" id="summaryValues">
                        <span class="value-item"><img src="images/cycling.png" alt="FTP"> FTP: <strong id="displayFTP">190</strong>W</span>
                        <span class="value-item"><img src="images/run.png" alt="配速"> 馬拉松: <strong id="displayRunPace">4:30</strong>/km</span>
                        <span class="value-item"><img src="images/swim.png" alt="CSS"> CSS: <strong id="displayCSS">2:30</strong>/100m</span>
                    </div>
                </div>
                <button class="btn-edit-settings" onclick="toggleSettingsPanel()">修改設定</button>
            </div>

            <!-- User Settings Panel (collapsible) -->
            <div class="user-settings-panel" id="settingsPanel" style="display: none;">
                <h3 class="settings-title">個人化訓練設定</h3>
                <p class="settings-desc">輸入您的能力數據，課表將自動調整為對應的功率與配速區間</p>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label>
                            <img src="images/cycling.png" class="setting-icon" alt="自行車">
                            FTP 功能閾值功率
                        </label>
                        <div class="input-group">
                            <input type="number" id="userFTP" min="100" max="500" placeholder="190">
                            <span class="unit">W</span>
                        </div>
                        <span class="setting-hint">自行車訓練會顯示對應的功率區間</span>
                    </div>
                    <div class="setting-item">
                        <label>
                            <img src="images/run.png" class="setting-icon" alt="跑步">
                            馬拉松配速
                        </label>
                        <div class="input-group">
                            <input type="text" id="userRunPace" placeholder="4:30" pattern="[0-9]{1,2}:[0-9]{2}">
                            <span class="unit">/km</span>
                        </div>
                        <span class="setting-hint">跑步訓練會顯示對應的配速區間</span>
                    </div>
                    <div class="setting-item">
                        <label>
                            <img src="images/swim.png" class="setting-icon" alt="游泳">
                            CSS 臨界游速
                        </label>
                        <div class="input-group">
                            <input type="text" id="userSwimCSS" placeholder="2:30" pattern="[0-9]{1,2}:[0-9]{2}">
                            <span class="unit">/100m</span>
                        </div>
                        <span class="setting-hint">游泳訓練會顯示對應的配速區間</span>
                    </div>
                </div>
                <div class="settings-actions">
                    <button class="btn-save-settings" onclick="saveUserSettings()">儲存設定</button>
                    <button class="btn-cancel-settings" onclick="toggleSettingsPanel()">取消</button>
                </div>
            </div>

            <h2 class="section-title">週訓練量總覽</h2>

            <!-- Weekly Summary with Integrated Phases -->
            <div class="weekly-summary">
                <div class="summary-cards">
                    <div class="summary-card" data-phase="build">
                        <div class="card-phase-header">
                            <span class="phase-icon">🏗️</span>
                            <div class="phase-info">
                                <h4>建構期</h4>
                                <span class="phase-weeks">Week 1-4</span>
                            </div>
                        </div>
                        <p class="phase-description">重建訓練量，打好有氧基礎</p>
                        <div class="card-content">
                            <div class="card-stat"><span class="label">游泳</span><span class="value">8-10km</span></div>
                            <div class="card-stat"><span class="label">自行車</span><span class="value">250-300km</span></div>
                            <div class="card-stat"><span class="label">跑步</span><span class="value">40-50km</span></div>
                            <div class="card-stat total"><span class="label">總時數</span><span class="value">18-21h</span></div>
                        </div>
                    </div>
                    <div class="summary-card featured" data-phase="strengthen">
                        <div class="card-phase-header">
                            <span class="phase-icon">💪</span>
                            <div class="phase-info">
                                <h4>強化期</h4>
                                <span class="phase-weeks">Week 5-9</span>
                            </div>
                        </div>
                        <p class="phase-description">最大訓練量，專項能力突破</p>
                        <div class="card-content">
                            <div class="card-stat"><span class="label">游泳</span><span class="value">12-14km</span></div>
                            <div class="card-stat"><span class="label">自行車</span><span class="value">350-400km</span></div>
                            <div class="card-stat"><span class="label">跑步</span><span class="value">55-60km</span></div>
                            <div class="card-stat total"><span class="label">總時數</span><span class="value">23-26h</span></div>
                        </div>
                    </div>
                    <div class="summary-card" data-phase="peak">
                        <div class="card-phase-header">
                            <span class="phase-icon">🔥</span>
                            <div class="phase-info">
                                <h4>巔峰期</h4>
                                <span class="phase-weeks">Week 10-11</span>
                            </div>
                        </div>
                        <p class="phase-description">半程模擬賽，驗證策略</p>
                        <div class="card-content">
                            <div class="card-stat"><span class="label">游泳</span><span class="value">12-13km</span></div>
                            <div class="card-stat"><span class="label">自行車</span><span class="value">320-340km</span></div>
                            <div class="card-stat"><span class="label">跑步</span><span class="value">50-52km</span></div>
                            <div class="card-stat total"><span class="label">總時數</span><span class="value">21-22h</span></div>
                        </div>
                    </div>
                    <div class="summary-card" data-phase="taper">
                        <div class="card-phase-header">
                            <span class="phase-icon">🎯</span>
                            <div class="phase-info">
                                <h4>減量期</h4>
                                <span class="phase-weeks">Week 12-13</span>
                            </div>
                        </div>
                        <p class="phase-description">恢復能量，迎接比賽</p>
                        <div class="card-content">
                            <div class="card-stat"><span class="label">游泳</span><span class="value">4-8km</span></div>
                            <div class="card-stat"><span class="label">自行車</span><span class="value">80-200km</span></div>
                            <div class="card-stat"><span class="label">跑步</span><span class="value">15-35km</span></div>
                            <div class="card-stat total"><span class="label">總時數</span><span class="value">6-13h</span></div>
                        </div>
                    </div>
                </div>
                <div class="total-training">
                    <div class="total-item">
                        <span class="total-label">總訓練天數</span>
                        <span class="total-value">90天</span>
                    </div>
                    <div class="total-item">
                        <span class="total-label">總游泳量</span>
                        <span class="total-value">139km</span>
                    </div>
                    <div class="total-item">
                        <span class="total-label">總自行車量</span>
                        <span class="total-value">3,910km</span>
                    </div>
                    <div class="total-item">
                        <span class="total-label">總跑步量</span>
                        <span class="total-value">622km</span>
                    </div>
                    <div class="total-item">
                        <span class="total-label">總訓練時數</span>
                        <span class="total-value">263h</span>
                    </div>
                </div>

                <!-- Weekly Mileage Chart -->
                <div class="weekly-chart-container">
                    <h3>每週訓練里程趨勢</h3>
                    <div class="chart-wrapper">
                        <canvas id="weeklyMileageChart"></canvas>
                    </div>
                </div>
            </div>

            <!-- Daily Schedule -->
            <div class="daily-schedule">
                <h3>每日訓練計劃</h3>
                <div class="schedule-filters">
                    <button class="filter-btn active" data-filter="all">全部</button>
                    <button class="filter-btn" data-filter="建構期">建構期</button>
                    <button class="filter-btn" data-filter="強化期">強化期</button>
                    <button class="filter-btn" data-filter="巔峰期">巔峰期</button>
                    <button class="filter-btn" data-filter="減量期">減量期</button>
                    <button class="filter-btn" data-filter="賽前週">賽前週</button>
                </div>
                <div class="schedule-table-container">
                    <table class="schedule-table" id="scheduleTable">
                        <thead>
                            <tr>
                                <th>週次</th>
                                <th>日期</th>
                                <th>階段</th>
                                <th>強度</th>
                                <th>訓練內容</th>
                                <th>游泳</th>
                                <th>自行車</th>
                                <th>跑步</th>
                                <th>時數</th>
                                <th>Garmin</th>
                            </tr>
                        </thead>
                        <tbody id="scheduleBody">
                            <!-- Populated by JavaScript -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </section>

    <!-- Strategy Section -->
    <section id="strategy" class="section strategy-section">
        <div class="container">
            <h2 class="section-title">訓練策略</h2>

            <div class="strategies">
                <!-- Swim Strategy -->
                <div class="strategy-card swim-card">
                    <div class="strategy-header">
                        <img src="images/swim.png" class="strategy-icon-img" alt="游泳">
                        <h3>游泳策略：技術突破</h3>
                    </div>
                    <div class="strategy-target">
                        <span class="from">2:49/100m</span>
                        <span class="arrow">→</span>
                        <span class="to">2:30/100m</span>
                        <span class="save">節省11分鐘</span>
                    </div>
                    <ul class="strategy-methods">
                        <li>每週2次技術課，提升劃頻至70-75 SPM</li>
                        <li>配速間歇訓練：6 x 400m @ 2:32/100m</li>
                        <li>每2週1次開放水域，適應澎湖海況</li>
                    </ul>
                </div>

                <!-- Bike Strategy -->
                <div class="strategy-card bike-card">
                    <div class="strategy-header">
                        <img src="images/cycling.png" class="strategy-icon-img" alt="自行車">
                        <h3>自行車策略：功率提升</h3>
                    </div>
                    <div class="strategy-target">
                        <span class="from">26.9 km/h</span>
                        <span class="arrow">→</span>
                        <span class="to">30.0 km/h</span>
                        <span class="save">節省41分鐘</span>
                    </div>
                    <ul class="strategy-methods">
                        <li>每週2次 Sweet Spot 訓練，提升FTP 10-15W</li>
                        <li>每週1次長距離160-180km，練習補給</li>
                        <li>側風訓練，適應澎湖賽道特性</li>
                        <li>磚式訓練強化騎轉跑能力</li>
                    </ul>
                </div>

                <!-- Run Strategy -->
                <div class="strategy-card run-card">
                    <div class="strategy-header">
                        <img src="images/run.png" class="strategy-icon-img" alt="跑步">
                        <h3>跑步策略：配速穩定</h3>
                    </div>
                    <div class="strategy-target">
                        <span class="from">6:09/km</span>
                        <span class="arrow">→</span>
                        <span class="to">5:49/km</span>
                        <span class="save">節省15分鐘</span>
                    </div>
                    <ul class="strategy-methods">
                        <li>配速分層：輕鬆跑60% + 馬拉松配速25% + 節奏跑15%</li>
                        <li>每週1次長跑25-28km，建立耐力</li>
                        <li>磚式訓練適應騎後跑步</li>
                        <li>中午時段訓練，適應澎湖高溫</li>
                    </ul>
                </div>
            </div>

        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logos">
                    <img src="images/garmin-logo-white.svg" alt="Garmin" class="footer-logo-img garmin-footer">
                </div>
                <div class="footer-tags">
                    <span class="tag">#鐵人三項</span>
                    <span class="tag">#Garmin</span>
                    <span class="tag">#訓練計劃</span>
                </div>
                <p class="footer-copyright" id="footerCopyright">© 鐵人三項訓練計劃</p>
            </div>
        </div>
    </footer>

    <!-- Workout Modal -->
    <div class="workout-modal" id="workoutModal">
        <div class="workout-modal-content" id="workoutModalContent">
            <!-- Content populated by JavaScript -->
        </div>
    </div>

    <script type="module" src="modules/main.js"></script>
</body>
</html>
